paises_af <- africa |>
filter(name %in% af)
paises_sa <- sa |>
filter(name %in% bra)
ggplot() +
geom_sf(data = africa) +
geom_sf(data = sa) +
geom_sf(data = paises_af, aes(fill = name), color = "black") +
geom_sf(data = paises_sa, aes(fill = name), color = "black") +
scale_fill_manual(values = c(cores_af, cores_sa), name = "Countries", guide = guide_legend(override.aes = list(shape = ".", size = 3)))+
theme(legend.key.size = unit(0.8, "lines"))+
theme_void()+
labs(title = "Countries of collection of antagonists of Hemileia vastatrix in South America and Africa")
africa <- ne_countries(continent = "Africa", returnclass = "sf")
sa <- ne_countries(continent = "South America", returnclass = "sf")
af <- c("Kenya", "Cameroon", "Ethiopia")
bra <- c("Brazil", "Paraguay")
cores_af <- c("green", "purple", "yellow")
cores_sa <- c("lightblue", "pink")
paises_af <- africa |>
filter(name %in% af)
paises_sa <- sa |>
filter(name %in% bra)
ggplot() +
geom_sf(data = africa) +
geom_sf(data = sa) +
geom_sf(data = paises_af, aes(fill = name), color = "black") +
geom_sf(data = paises_sa, aes(fill = name), color = "black") +
scale_fill_manual(values = c(cores_af, cores_sa), name = "Countries", guide = guide_legend(override.aes = list(shape = ".", size = 3)))+
theme(legend.key.size = unit(0.8, "lines"))+
labs(title = "Countries of collection of antagonists of Hemileia vastatrix in South America and Africa")
ggsave("imgs/mapa.png", dpi = 600, height = 4, width = 7)
africa <- ne_countries(continent = "Africa", returnclass = "sf")
sa <- ne_countries(continent = "South America", returnclass = "sf")
af <- c("Kenya", "Cameroon", "Ethiopia")
bra <- c("Brazil", "Paraguay")
cores_af <- c("green", "purple", "yellow")
cores_sa <- c("lightblue", "pink")
paises_af <- africa |>
filter(name %in% af)
paises_sa <- sa |>
filter(name %in% bra)
ggplot() +
geom_sf(data = africa) +
geom_sf(data = sa) +
geom_sf(data = paises_af, aes(fill = name), color = "black") +
geom_sf(data = paises_sa, aes(fill = name), color = "black") +
scale_fill_manual(values = c(cores_af, cores_sa), name = "Countries", guide = guide_legend(override.aes = list(shape = ".", size = 3)))+
theme(legend.key.size = unit(0.8, "lines"))+
labs(title = "Countries of collection of antagonists of Hemileia vastatrix")
ggsave("imgs/mapa.png", dpi = 600, height = 4, width = 7)
africa <- ne_countries(continent = "Africa", returnclass = "sf")
sa <- ne_countries(continent = "South America", returnclass = "sf")
af <- c("Kenya", "Cameroon", "Ethiopia")
bra <- c("Brazil", "Paraguay")
cores_af <- c("green", "purple", "yellow")
cores_sa <- c("lightblue", "pink")
paises_af <- africa |>
filter(name %in% af)
paises_sa <- sa |>
filter(name %in% bra)
ggplot() +
geom_sf(data = africa) +
geom_sf(data = sa) +
geom_sf(data = paises_af, aes(fill = name), color = "black") +
geom_sf(data = paises_sa, aes(fill = name), color = "black") +
scale_fill_manual(values = c(cores_af, cores_sa), name = "Countries", guide = guide_legend(override.aes = list(shape = ".", size = 3)))+
theme(legend.key.size = unit(0.8, "lines"),
plot.margin = margin(20, 20, 40, 20))+
labs(title = "Countries of collection of antagonists of Hemileia vastatrix in South America and Africa")
africa <- ne_countries(continent = "Africa", returnclass = "sf")
sa <- ne_countries(continent = "South America", returnclass = "sf")
af <- c("Kenya", "Cameroon", "Ethiopia")
bra <- c("Brazil", "Paraguay")
cores_af <- c("green", "purple", "yellow")
cores_sa <- c("lightblue", "pink")
paises_af <- africa |>
filter(name %in% af)
paises_sa <- sa |>
filter(name %in% bra)
ggplot() +
geom_sf(data = africa) +
geom_sf(data = sa) +
geom_sf(data = paises_af, aes(fill = name), color = "black") +
geom_sf(data = paises_sa, aes(fill = name), color = "black") +
scale_fill_manual(values = c(cores_af, cores_sa), name = "Countries", guide = guide_legend(override.aes = list(shape = ".", size = 3)))+
theme(legend.key.size = unit(0.8, "lines"),
plot.title = element_text(size = 12))+
labs(title = "Countries of collection of antagonists of Hemileia vastatrix in South America and Africa")
africa <- ne_countries(continent = "Africa", returnclass = "sf")
sa <- ne_countries(continent = "South America", returnclass = "sf")
af <- c("Kenya", "Cameroon", "Ethiopia")
bra <- c("Brazil", "Paraguay")
cores_af <- c("green", "purple", "yellow")
cores_sa <- c("lightblue", "pink")
paises_af <- africa |>
filter(name %in% af)
paises_sa <- sa |>
filter(name %in% bra)
ggplot() +
geom_sf(data = africa) +
geom_sf(data = sa) +
geom_sf(data = paises_af, aes(fill = name), color = "black") +
geom_sf(data = paises_sa, aes(fill = name), color = "black") +
scale_fill_manual(values = c(cores_af, cores_sa), name = "Countries", guide = guide_legend(override.aes = list(shape = ".", size = 3)))+
theme(legend.key.size = unit(0.8, "lines"),
plot.title = element_text(size = 10))+
labs(title = "Countries of collection of antagonists of Hemileia vastatrix in South America and Africa")
africa <- ne_countries(continent = "Africa", returnclass = "sf")
sa <- ne_countries(continent = "South America", returnclass = "sf")
af <- c("Kenya", "Cameroon", "Ethiopia")
bra <- c("Brazil", "Paraguay")
cores_af <- c("green", "purple", "yellow")
cores_sa <- c("lightblue", "pink")
paises_af <- africa |>
filter(name %in% af)
paises_sa <- sa |>
filter(name %in% bra)
ggplot() +
geom_sf(data = africa) +
geom_sf(data = sa) +
geom_sf(data = paises_af, aes(fill = name), color = "black") +
geom_sf(data = paises_sa, aes(fill = name), color = "black") +
scale_fill_manual(values = c(cores_af, cores_sa), name = "Countries", guide = guide_legend(override.aes = list(shape = ".", size = 3)))+
theme(legend.key.size = unit(0.8, "lines"),
plot.title = element_text(size = 11))+
labs(title = "Countries of collection of antagonists of Hemileia vastatrix in South America and Africa")
ggsave("imgs/mapa2.png", dpi = 600, height = 4, width = 7)
africa <- ne_countries(continent = "Africa", returnclass = "sf")
sa <- ne_countries(continent = "South America", returnclass = "sf")
af <- c("Kenya", "Cameroon", "Ethiopia")
bra <- c("Brazil", "Paraguay")
cores_af <- c("green", "purple", "yellow")
cores_sa <- c("lightblue", "pink")
paises_af <- africa |>
filter(name %in% af)
paises_sa <- sa |>
filter(name %in% bra)
ggplot() +
geom_sf(data = africa) +
geom_sf(data = sa) +
geom_sf(data = paises_af, aes(fill = name), color = "black") +
geom_sf(data = paises_sa, aes(fill = name), color = "black") +
scale_fill_manual(values = c(cores_af, cores_sa), name = "Countries", guide = guide_legend(override.aes = list(shape = ".", size = 3)))+
theme(legend.key.size = unit(0.8, "lines"))+
labs(title = "Countries of collection of antagonists of Hemileia vastatrix in South America and Africa")
#| warning: false
#| message: false
library(tidyverse)
library(googlesheets4)
library(gsheet)
library(dplyr)
library(ggplot2)
library(performance)
library(DHARMa)
library(ExpDes.pt)
library(agricolae)
library(epifitter)
controle |>
ggplot(aes(tempo_dai, sev,
color = trat))+
geom_jitter(size = 2, width = 2)+
theme_bw()+
labs(title="", x="Time (days after inoculation)", y = "Disease severity (%)", color = "Treatments")+
scale_y_continuous(breaks = seq(0, 40, 5), limits = c(0, 40))+
scale_x_continuous(breaks = seq(0, 75, 15), limits = c(0, 75))
controle <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=2004591437")
controle |>
ggplot(aes(tempo_dai, sev,
color = trat))+
geom_jitter(size = 2, width = 2)+
theme_bw()+
labs(title="", x="Time (days after inoculation)", y = "Disease severity (%)", color = "Treatments")+
scale_y_continuous(breaks = seq(0, 40, 5), limits = c(0, 40))+
scale_x_continuous(breaks = seq(0, 75, 15), limits = c(0, 75))
#| warning: false
#| message: false
controle2 <- controle |>
group_by(trat, tempo_dai) |>
summarise(sev_mean = mean(sev),
sev_sd = sd(sev))
controle2 |>
ggplot(aes(tempo_dai, sev_mean,
color = trat))+
geom_line(aes(group = trat, color = trat), size = 1)+
geom_point(aes(fill = trat), shape = 21, size = 2)+
scale_color_viridis_d(option = "D")+
scale_fill_viridis_d(option = "D")+
theme_bw()+
geom_errorbar(aes(ymin = sev_mean-sev_sd, ymax = sev_mean+sev_sd), width=0, alpha = 1)+
labs(title="", x="Time (days after inoculation)", y = "Disease severity (%)")+
scale_y_continuous(breaks = seq(0, 25, 5), limits = c(0, 25))+
scale_x_continuous(breaks = seq(0, 75, 15), limits = c(0, 75))
controle2 |>
ggplot(aes(tempo_dai, sev_mean,
color = trat))+
geom_line(aes(group = trat, color = trat), size = 1)+
geom_point(aes(fill = trat), shape = 21, size = 2)+
facet_wrap(~trat)+
scale_color_viridis_d(option = "D")+
scale_fill_viridis_d(option = "D")+
theme_bw()+
geom_errorbar(aes(ymin = sev_mean-sev_sd, ymax = sev_mean+sev_sd), width=0, alpha = 1)+
labs(title="", x="Time (days after inoculation)", y = "Disease severity (%)")+
scale_y_continuous(breaks = seq(0, 25, 5), limits = c(0, 25))+
scale_x_continuous(breaks = seq(0, 75, 15), limits = c(0, 75))
sevf <- controle |>
filter(tempo_dai == 75)
sevf |>
ggplot(aes(trat, sev))+
geom_jitter(shape = 1, size = 1.5)+
geom_boxplot(fill = NA, size = .7)+
theme_bw()+
scale_y_continuous(breaks = seq(0, 37, 5), limits = c(0, 37))+
labs(x = "",
y = "Final severity (%)")
c2 <- controle |>
filter(tempo_dai == 75) |>
filter(sev != "NA")
c2$bloco = as.factor(c2$bloco)
aov_c2 <- aov(sev ~ trat*tempo_dai + factor(bloco), data = c2)
summary(aov_c2)
check_normality(aov_c2)
check_heteroscedasticity(aov_c2)
plot(simulateResiduals(aov_c2))
c2$bloco = as.factor(c2$bloco)
aov_c2 <- aov(log(sev + 0.5) ~ trat*tempo_dai + factor(bloco), data = c2)
summary(aov_c2)
check_normality(aov_c2)
check_heteroscedasticity(aov_c2)
plot(simulateResiduals(aov_c2))
c2 <- controle |>
filter(tempo_dai == 75) |>
filter(sev != "NA")
c2$bloco = as.factor(c2$bloco)
dbc(c2$trat, factor(c2$bloco), c2$sev, quali = (TRUE), mcomp = "sk", sigT = 0.05,sigF = 0.05, unfold = NULL)
c2$bloco = as.factor(c2$bloco)
dbc(c2$trat, factor(c2$bloco), log(c2$sev + 0.5), quali = (TRUE), mcomp = "sk", sigT = 0.05,sigF = 0.05, unfold = NULL)
#| warning: false
#| message: false
c3 <- controle |>
filter(sev != "NA") |>
filter(tempo_dai != 0) |>
group_by(trat, bloco) |>
summarise(AACPD = AUDPC(tempo_dai, sev))
c3
summary(c3$AACPD)
c3$bloco = as.factor(c3$bloco)
dbc(c3$trat, factor(c3$bloco), c3$AACPD, quali = (TRUE), mcomp = "sk", sigT = 0.05,sigF = 0.05, unfold = NULL)
incid <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1007691733")
inc1 <- incid |>
dplyr::select(trat, bloco, inc) |>
filter(inc != "NA")
inc1 |>
ggplot(aes(trat, inc))+
geom_col(width = .6)+
theme_bw()+
scale_y_continuous(breaks = seq(0, 100, 10), limits = c(0, 100))
#| warning: false
#| message: false
inc2 <- inc1 |>
filter(!is.na(inc)) |>
group_by(trat) |>
summarise(inc_mean = mean(inc),
inc_sd = sd(inc))
inc2 |>
ggplot(aes(trat, inc_mean))+
geom_col(width = .6)+
theme_bw()+
geom_errorbar(aes(ymin = inc_mean-inc_sd, ymax = inc_mean+inc_sd), width=0, alpha = 1)+
labs(title="", x="Treatments", y = " Incidence (%)")+
scale_y_continuous(breaks = seq(0, 100, 10), limits = c(0, 100))
inc3 <- inc1 |>
filter(inc != "NA")
inc3$bloco = as.factor(inc3$bloco)
aov1 <- aov(inc ~ trat + factor(bloco), data = inc3)
summary(aov1)
check_normality(aov1)
check_heteroscedasticity(aov1)
plot(simulateResiduals(aov1))
inc3$bloco = as.factor(inc3$bloco)
dbc(inc3$trat, factor(inc3$bloco), inc3$inc, quali = (TRUE), mcomp = "sk", sigT = 0.05,sigF = 0.05, unfold = NULL)
inc3$bloco = as.factor(inc3$bloco)
dbc(inc3$trat, factor(inc3$bloco), log(inc3$inc + 0.5), quali = (TRUE), mcomp = "sk", sigT = 0.05,sigF = 0.05, unfold = NULL)
altura <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1007691733")
alt1 <- altura |>
dplyr::select(trat, bloco, alt) |>
filter(alt != "NA")
alt1 |>
ggplot(aes(trat, alt))+
geom_col(width = .6)+
theme_bw()+
scale_y_continuous(breaks = seq(0, 100, 10), limits = c(0, 100))
alt2 <- alt1 |>
filter(!is.na(alt)) |>
group_by(trat) |>
summarise(alt_mean = mean(alt),
alt_sd = sd(alt))
alt2 |>
ggplot(aes(trat, alt_mean))+
geom_col(width = .6)+
theme_bw()+
geom_errorbar(aes(ymin = alt_mean-alt_sd, ymax = alt_mean+alt_sd), width=0, alpha = 1)+
labs(title="", x="Treatments", y = "Plant height (cm)")+
scale_y_continuous(breaks = seq(0, 50, 10), limits = c(0, 50))
alt3 <- alt1 |>
filter(alt != "NA")
alt3$bloco = as.factor(alt3$bloco)
aov2 <- aov(alt ~ trat + factor(bloco), data = alt3)
summary(aov2)
check_normality(aov2)
check_heteroscedasticity(aov2)
plot(simulateResiduals(aov2))
alt3$bloco = as.factor(alt3$bloco)
dbc(alt3$trat, factor(alt3$bloco), alt3$alt, quali = TRUE, mcomp = "sk", sigT = 0.05)
alt3$bloco = as.factor(alt3$bloco)
dbc(alt3$trat, factor(alt3$bloco), log(alt3$alt + 0.5), quali = TRUE, mcomp = "sk", sigT = 0.05)
corsev <- controle |>
filter(sev != "NA") |>
group_by(trat, bloco) |>
summarise(sev_mean = mean(sev))
corsev
cor.test(corsev$sev_mean, c3$AACPD)
plot(corsev$sev_mean, c3$AACPD)
cor <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1007691733")
cor |>
ggplot(aes(inc, alt))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()+
labs(x = "Disease incidence (%)", y = "Plant height (cm)") +
ggtitle("Relationship between disease incidence and plant height")
cor |>
ggplot(aes(inc, alt, color = alt))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()+
labs(x = "Disease incidence (%)", y = "Plant height (cm)") +
ggtitle("Relationship between disease incidence and plant height")
cor |>
ggplot(aes(inc, alt, color = trat))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()+
labs(x = "Disease incidence (%)", y = "Plant height (cm)") +
ggtitle("Relationship between disease incidence and plant height")
cor |>
ggplot(aes(inc, alt, color))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()+
labs(x = "Disease incidence (%)", y = "Plant height (cm)") +
ggtitle("Relationship between disease incidence and plant height")
cor |>
ggplot(aes(inc, alt))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()+
labs(x = "Disease incidence (%)", y = "Plant height (cm)") +
ggtitle("Relationship between disease incidence and plant height")
cor2 <- cor |>
dplyr::select(trat, bloco, inc, alt) |>
filter(alt != "NA")
cor.test(cor2$inc, cor2$alt)
plot(cor2$inc, cor2$alt)
sev_cor <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1796689464")
sev_alt <- sev_cor |>
filter(alt != "NA") |>
mutate(sev_final = as.numeric(sev_final))
sev_alt |>
ggplot(aes(sev_final, alt))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()
sev_alt <- sev_cor |>
filter(alt != "NA") |>
mutate(sev_final = as.numeric(sev_final))
sev_alt |>
ggplot(aes(sev_final, alt, color = trat))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()
sev_alt <- sev_cor |>
filter(alt != "NA") |>
mutate(sev_final = as.numeric(sev_final))
sev_alt |>
ggplot(aes(sev_final, alt))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()
cor.test(sev_alt$sev_final, sev_alt$alt)
plot(sev_alt$sev_final, sev_alt$alt)
reg <- lm(alt ~ sev_final, data = sev_alt)
summary(reg)
sev_alt |>
ggplot(aes(alt,sev, color = trat))+
geom_point()+
geom_smooth(method ="lm", se =F)
sev_alt |>
ggplot(aes(alt,sev_final, color = trat))+
geom_point()+
geom_smooth(method ="lm", se =F)
#| warning: false
#| message: false
library(tidyverse)
library(googlesheets4)
library(gsheet)
library(dplyr)
library(ggplot2)
library(performance)
library(DHARMa)
library(ExpDes.pt)
library(agricolae)
library(epifitter)
cont <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=2004591437")
#| warning: false
#| message: false
cont_aacpd <- cont |>
filter(sev != "NA") |>
filter(tempo_dai != 0) |>
group_by(trat, bloco) |>
summarise(aucpd = aucpd(tempo_dai, sev))
#| warning: false
#| message: false
cont_aacpd <- cont |>
filter(sev != "NA") |>
filter(tempo_dai != 0) |>
group_by(trat, bloco) |>
summarise(audpc = audpc(tempo_dai, sev))
cont_aacpd
summary(cont_aacpd$audpc)
View(cont_aacpd)
cont_aacpd$bloco = as.factor(cont_aacpd$bloco)
dbc(cont_aacpd$trat, factor(cont_aacpd$bloco), cont_aacpd$audpc, quali = (TRUE), mcomp = "sk", sigT = 0.05,sigF = 0.05, unfold = NULL)
#| warning: false
#| message: false
cont_aacpd <- cont |>
filter(sev != "NA") |>
filter(tempo_dai != 0) |>
group_by(trat, bloco) |>
summarise(audpc = audpc(sev, tempo_dai))
cont_aacpd
summary(cont_aacpd$audpc)
cont_aacpd$bloco = as.factor(cont_aacpd$bloco)
dbc(cont_aacpd$trat, factor(cont_aacpd$bloco), cont_aacpd$audpc, quali = (TRUE), mcomp = "sk", sigT = 0.05,sigF = 0.05, unfold = NULL)
library(ScottKnott)
cont_aacpd$bloco = as.factor(cont_aacpd$bloco)
sk1 <- SK(audpc ~ trat,  data=cont_aacpd,
which='trat')
cont_aacpd$bloco = as.factor(cont_aacpd$bloco)
sk1 <- SK(audpc ~ trat,  data=cont_aacpd,
which='trat')
View(sk1)
summary(sk1)
#| warning: false
#| message: false
library(tidyverse)
library(googlesheets4)
library(gsheet)
library(dplyr)
library(ggplot2)
library(performance)
library(DHARMa)
library(ExpDes.pt)
library(agricolae)
library(epifitter)
controle <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=2004591437")
head(controle)
incid <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1007691733")
head(incid)
altura <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1007691733")
head(altura)
sev_cor <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1796689464")
head(sev_cor)
cor <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1007691733")
head(cor)
sev_alt |>
ggplot(aes(alt,sev_final, color = trat))+
geom_point()+
geom_smooth(method ="lm", se =F)
#| warning: false
#| message: false
library(tidyverse)
library(googlesheets4)
library(gsheet)
library(dplyr)
library(ggplot2)
library(performance)
library(DHARMa)
library(ExpDes.pt)
library(agricolae)
library(epifitter)
sev_cor <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1796689464")
head(sev_cor)
sev_cor <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bw5wWl5dZHis32FU8C60o1xT4HbXqeC9/edit#gid=1796689464")
head(sev_cor)
sev_alt <- sev_cor |>
filter(alt != "NA") |>
mutate(sev_final = as.numeric(sev_final))
sev_alt |>
ggplot(aes(sev_final, alt))+
geom_point()+
geom_smooth(se = F, method = "lm")+
theme_bw()
cor.test(sev_alt$sev_final, sev_alt$alt)
sev_alt |>
ggplot(aes(alt,sev_final, color = trat))+
geom_point()+
geom_smooth(method ="lm", se =F)
reg <- lm(alt ~ sev_final, data = sev_alt)
summary(reg)
plot(sev_alt)
